<div class="modern-course-card" [class.enrolled-card]="isEnrolled">
  <!-- Course Image Container -->
  <div class="course-image-container">
    <img 
      [src]="course.image" 
      [alt]="course.title"
      class="course-image"
      (error)="$event.target.src='https://images.unsplash.com/photo-1516321318423-f06f85e504b3?w=400&h=250&fit=crop'"
    >
    
    <!-- Image Overlay -->
    <div class="image-overlay">
      <!-- Enrollment Badge -->
      <div class="enrollment-badge" *ngIf="isEnrolled">
        <mat-icon>check_circle</mat-icon>
        <span>Enrolled</span>
      </div>

      <!-- Level Badge -->
      <div class="level-badge" [ngClass]="'level-' + course.level.toLowerCase()">
        <mat-icon>{{getLevelIcon(course.level)}}</mat-icon>
        <span>{{course.level}}</span>
      </div>

      <!-- Price Badge -->
      <div class="price-badge" [class.free-badge]="course.price === 0">
        <span class="price-amount">{{formatPrice(course.price)}}</span>
      </div>
    </div>

    <!-- Course Duration Overlay -->
    <div class="duration-overlay">
      <mat-icon>schedule</mat-icon>
      <span>{{formatDuration(course.duration)}}</span>
    </div>
  </div>

  <!-- Course Content -->
  <div class="course-content">
    <!-- Course Header -->
    <div class="course-header">
      <!-- Category -->
      <div class="course-category">
        <mat-icon>{{getCategoryIcon(course.category)}}</mat-icon>
        <span>{{course.category}}</span>
      </div>

      <!-- Quick Actions -->
      <div class="quick-actions" *ngIf="showActions">
        <!-- Admin Actions -->
        <button mat-icon-button 
                [routerLink]="['/courses/edit', course.id]"
                class="action-btn edit-btn"
                *ngIf="isAdmin"
                matTooltip="Edit Course">
          <mat-icon>edit</mat-icon>
        </button>

        <!-- Bookmark/Save Action (Future Feature) -->
        <button mat-icon-button 
                class="action-btn bookmark-btn"
                *ngIf="isStudent || !isLoggedIn"
                matTooltip="Save for Later">
          <mat-icon>bookmark_border</mat-icon>
        </button>
      </div>
    </div>

    <!-- Course Title -->
    <h3 class="course-title" [routerLink]="['/courses', course.id]">
      {{course.title}}
    </h3>

    <!-- Course Description -->
    <p class="course-description">
      {{course.description.length > 100 ? (course.description | slice:0:100) + '...' : course.description}}
    </p>

    <!-- Instructor Info -->
    <div class="instructor-info">
      <div class="instructor-avatar">
        <mat-icon>person</mat-icon>
      </div>
      <div class="instructor-details">
        <span class="instructor-name">{{course.instructor}}</span>
        <span class="instructor-title">Expert Instructor</span>
      </div>
    </div>

    <!-- Course Stats -->
    <div class="course-stats">
      <!-- Rating -->
      <div class="stat-item rating-stat">
        <div class="rating-display">
          <div class="rating-stars">
            <mat-icon class="star filled" *ngFor="let star of ratingStars">star</mat-icon>
            <mat-icon class="star half" *ngIf="hasPartialStar">star_half</mat-icon>
            <mat-icon class="star empty" *ngFor="let star of emptyStars">star_border</mat-icon>
          </div>
          <span class="rating-value">{{course.rating | number:'1.1-1'}}</span>
        </div>
        <span class="rating-count">({{course.studentsEnrolled | number}})</span>
      </div>

      <!-- Students Enrolled -->
      <div class="stat-item">
        <mat-icon>people</mat-icon>
        <span>{{course.studentsEnrolled | number}} students</span>
      </div>
    </div>

    <!-- Course Tags -->
    <div class="course-tags" *ngIf="course.tags && course.tags.length > 0">
      <div class="tags-container">
        <span class="course-tag" *ngFor="let tag of course.tags.slice(0, 3)">
          {{tag}}
        </span>
        <span class="more-tags" *ngIf="course.tags.length > 3">
          +{{course.tags.length - 3}} more
        </span>
      </div>
    </div>
  </div>

  <!-- Course Actions -->
  <div class="course-actions" *ngIf="showActions">
    <div class="action-row">
      <!-- View Details Button -->
      <button mat-button 
              [routerLink]="['/courses', course.id]"
              class="details-btn">
        <mat-icon>visibility</mat-icon>
        <span>View Details</span>
      </button>

      <!-- Main Action Button -->
      <div class="main-action">
        <!-- Student Enroll/Unenroll Button -->
        <button mat-raised-button 
                *ngIf="showEnrollButton && isStudent"
                (click)="onEnroll()"
                [class]="isEnrolled ? 'enrolled-btn' : 'enroll-btn'"
                [disabled]="isLoading">
          <mat-spinner diameter="20" *ngIf="isLoading"></mat-spinner>
          <mat-icon *ngIf="!isLoading">{{isEnrolled ? 'check' : 'add'}}</mat-icon>
          <span>{{isEnrolled ? 'Enrolled' : 'Enroll Now'}}</span>
        </button>

        <!-- Admin Edit Button -->
        <button mat-raised-button 
                [routerLink]="['/courses/edit', course.id]"
                class="admin-edit-btn"
                *ngIf="isAdmin">
          <mat-icon>edit</mat-icon>
          <span>Edit Course</span>
        </button>

        <!-- Login Prompt for Non-logged Users -->
        <button mat-raised-button 
                routerLink="/auth/login"
                *ngIf="!isLoggedIn && showEnrollButton"
                class="login-prompt-btn">
          <mat-icon>login</mat-icon>
          <span>Login to Enroll</span>
        </button>
      </div>
    </div>
  </div>

  <!-- Progress Bar for Enrolled Students (Future Feature) -->
  <div class="progress-section" *ngIf="isEnrolled">
    <div class="progress-info">
      <span class="progress-label">Course Progress</span>
      <span class="progress-percentage">65%</span>
    </div>
    <mat-progress-bar mode="determinate" value="65" class="course-progress-bar"></mat-progress-bar>
  </div>
</div>